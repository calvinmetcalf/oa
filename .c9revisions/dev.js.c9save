{"ts":1340893230515,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"var fURL = \"http://oa-otp.rhcloud.com/oa.jsonp\";\nvar m,d;\nvar zoom = 8;\nvar g = google.maps;\nvar center = new g.LatLng(41.914541,-71.592407);\nvar infowindow = new g.InfoWindow();\nvar pN =[];\nvar geocoder = new g.Geocoder();\nvar geomarker;\n\n\n$(function() {\n      $( \"#tabs\" ).tabs({\n        \tcollapsible: true,\n            selected: -1\n\t\t});\n          $( \"input:submit,input:reset\" ).button();\n        $('input, textarea').placeholder();\n   m = new g.Map(document.getElementById('map'), {\n      center: center,\n      zoom: zoom,\n      mapTypeId: 'roadmap'\n    });\ngetStuff(fURL);\n\n\n}\n);\n\nvar doStuff = function doStuff(data){\nvar types = [];\nvar holders = [];\nvar cities = [];\n\nd = data.signs;\n$.each(d,function(i,s){\n    var permit = s.Permit;\n    var holder = s.PermitHoldersName;\n    var rif = s.RoadIntendedToFace;\n    var city = s.SignCity;\n    var type = s.SignType;\n    var lat = parseFloat(s.lat);\n    var lng = parseFloat(s.lng);\n    var icon;\n    \n    if($.inArray(type,types)==-1){\n        types.push(type);\n    }\n    if($.inArray(holder,holders)==-1){\n        holders.push(holder);\n    }\n    if($.inArray(city,cities)==-1){\n        cities.push(city);\n    }\n    if($.inArray(permit,pN)==-1){\n        pN.push(permit);\n    }\n    if(s.Icon == \"small_red\"){\n        icon = new g.MarkerImage(\"img/smallred.png\");\n    }else if(s.Icon == \"small_green\"){\n        icon = new g.MarkerImage(\"img/smallgreen.png\");\n    }else if(s.Icon == \"small_yellow\"){\n        icon = new g.MarkerImage(\"img/smallyellow.png\");\n    }\n    var content =\"<div class='oainfo' ><dl><dt>Permit Numbers</dt><dd>\" + permit + \"</dd><dt>Permit Holder</dt><dd>\" + holder + \"</dd><dt>Sign Type</dt><dd>\" + type + \"</dd><dt>Facing</dt><dd>\" + rif + \"</dd><dt>Municipality</dt><dd>\" + city + \"</dd></dl></div>\";\n     s.marker = new g.Marker({position: new g.LatLng(lat,lng),title:permit,icon:icon});\n     s.marker.setMap(m)\n     g.event.addListener(s.marker, 'click',\n                    \t\tfunction()\n\t\t\t\t\t\t\t{\n                                infowindow.setContent(content);\n                              infowindow.open(m,s.marker);\n\t\t\t\t\t\t\t});\n    \n    \n    \n}); \n$.each(types,function(i,t){\n    $('.signType').append(\"<option value='\" + t + \"'>\" + t + \"</option>\");\n}\n    \n    );\n   $.each(holders,function(i,t){\n    $('.holders').append(\"<option value='\" + t + \"'>\" + t + \"</option>\");\n}\n    \n    );\n     $.each(cities,function(i,t){\n    $('.city').append(\"<option value='\" + t + \"'>\" + t + \"</option>\");\n}\n    \n    );\n    $( \"#permitNumber\" ).autocomplete({\n        \tsource: pN,\n             minLength: 1\n\t\t});\n};\n\nvar getStuff = function(url){\n $.get(url,\nfunction(data){\n    \n    doStuff(data);\n}, 'JSONP');   \n};\n\n$('#sper').click(function(){\n    var perno = $('#permitNumber').val();\n    $.each(d,function(i,s){\n    if(s.Permit==perno){\n        s.marker.setMap(m);\n    }else{\n        s.marker.setMap(null);\n    }\n    });\n}\n    \n    );\n$('#rper').click(function(){\n    qMap();\n});\n$(\"select\").change(function(){\nqMap();\n});\n\nvar qMap = function(){\n    var t = $('.signType').val();    \nvar h = $('.holders').val();\nvar c = $('.city').val();\n$.each(d,function(i,s){\n    if(((t=='all')||(t==s.SignType))&&((h=='all')||(h==s.PermitHoldersName))&&((c=='all')||(c==s.SignCity))){\n       s.marker.setMap(m);\n    }else{\n        s.marker.setMap(null);\n    }\n}\n);\n}\n\n$('#geocode').click(function(){\n    geocoder.geocode( { 'address': $(\"#address\").val()}, function(results, status) {\n      if (status == g.GeocoderStatus.OK) {\n        m.setCenter(results[0].geometry.location);\n        m.setZoom(14);\n     geomarker = new g.Marker({\n            map: m, \n            position: results[0].geometry.location\n        });\n      } else {\n        alert(\"Geocode was not successful for the following reason: \" + status);\n      }\n    });\n}\n);\n\n$('#resetgeo').click(function(){\n      m.setCenter(center);\n    m.setZoom(zoom);\ngeomarker.setMap(null);\n});"]],"start1":0,"start2":0,"length1":0,"length2":3908}]],"length":3908}
